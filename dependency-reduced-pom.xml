<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.springframework</groupId>
  <artifactId>hello-world</artifactId>
  <version>0.1.0</version>
  <build>
    <plugins>
      <plugin>
        <artifactId>maven-shade-plugin</artifactId>
        <version>3.2.4</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
            <configuration>
              <transformers>
                <transformer>
                  <mainClass>hello.HelloWorld</mainClass>
                </transformer>
              </transformers>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.eclipse.jkube</groupId>
        <artifactId>kubernetes-maven-plugin</artifactId>
        <version>${jkube.version}</version>
        <extensions>true</extensions>
        <configuration>
          <verbose>true</verbose>
          <images>
            <image>
              <name>${docker.image.path}</name>
              <build>
                <dockerFile>${docker.dockerfile.path}</dockerFile>
                <args>
                  <JAR_FILE>${docker.application.jar}</JAR_FILE>
                  <ASSEMBLY_PATH>${docker.assembly.path}</ASSEMBLY_PATH>
                </args>
                <contextDir>${project.basedir}</contextDir>
                <tags>
                  <tag>${project.version}</tag>
                </tags>
                <assembly>
                  <name>target</name>
                </assembly>
              </build>
            </image>
          </images>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <properties>
    <maven.compiler.target>1.8</maven.compiler.target>
    <jkube.helm.home>src/main/helm-chart</jkube.helm.home>
    <docker.application.jar>${docker.assembly.path}/${project.artifactId}-${project.version}.jar</docker.application.jar>
    <maven.compiler.source>1.8</maven.compiler.source>
    <docker.assembly.path>target</docker.assembly.path>
    <jkube.version>1.1.0</jkube.version>
    <docker.image.path>asms/${project.artifactId}:${project.version}</docker.image.path>
    <docker.dockerfile.path>${project.basedir}/src/main/docker/Dockerfile</docker.dockerfile.path>
  </properties>
</project>
